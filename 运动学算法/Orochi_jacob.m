%%%%%%%%%%%%%%%%%%%%%%% 7DOF协作机器人雅克比矩阵求解 %%%%%%%%%%%%%%%%%%%%%%%%
% Author: Nym
% Date: 2019/10/17
% DH: MDH
% 7 DOF Cooperative Robot
% 组装成的J矩阵为6×7矩阵，行数为自由度数，列数为机械臂关节数，矩阵非方阵，
% 因此采用求广义逆的方式或位姿分离讨论的方法进行后续分析；
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [J] = Orochi_jacob(q1,q2,q3,q4,q5,q6,~)

% 连杆偏移参数
Dse = 0.4; 
Dew = 0.4; 
Dwt = 0;
% q1 = -1.57; q2 = 1.57; q3 = 1.57; q4 = 1.57; q5 = 1.57; q6 = 1.57; q7 = 1.57;  
J_00 = -Dwt*sin(q6)*sin(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5) +...
       Dwt*sin(q6)*sin(q4)*sin(q1)*sin(q2)*cos(q5) +...
       Dwt*sin(q6)*sin(q1)*sin(q3)*cos(q2)*sin(q5) - ...
       Dwt*sin(q6)*sin(q3)*cos(q1)*cos(q4)*cos(q5) -...
       Dwt*sin(q4)*sin(q1)*cos(q2)*cos(q3)*cos(q6) -...
       Dew*sin(q4)*sin(q1)*cos(q2)*cos(q3) -...
       Dwt*sin(q6)*cos(q1)*cos(q3)*sin(q5) -... 
       Dwt*sin(q4)*sin(q3)*cos(q1)*cos(q6) -...
       Dwt*sin(q1)*cos(q4)*sin(q2)*cos(q6) -...
       Dew*sin(q4)*sin(q3)*cos(q1) -...
       Dew*sin(q1)*cos(q4)*sin(q2) - Dse*sin(q1)*sin(q2);   
J_01 = -cos(q1)*(Dwt*sin(q6)*cos(q3)*cos(q4)*sin(q2)*cos(q5) +...
       Dwt*sin(q6)*sin(q4)*cos(q2)*cos(q5) -...
       Dwt*sin(q6)*sin(q3)*sin(q2)*sin(q5) +... 
       Dwt*sin(q4)*cos(q3)*sin(q2)*cos(q6) +...
       Dew*sin(q4)*cos(q3)*sin(q2) - Dwt*cos(q2)*cos(q4)*cos(q6) -...
       Dew*cos(q2)*cos(q4) - Dse*cos(q2));   
J_02 = -Dwt*sin(q6)*sin(q3)*cos(q1)*cos(q2)*cos(q4)*cos(q5) -...
       Dwt*sin(q6)*sin(q1)*cos(q3)*cos(q4)*cos(q5) -...
       Dwt*sin(q6)*cos(q1)*cos(q2)*cos(q3)*sin(q5) -...
       Dwt*sin(q4)*sin(q3)*cos(q1)*cos(q2)*cos(q6) -...
       Dew*sin(q4)*sin(q3)*cos(q1)*cos(q2) +...
       Dwt*sin(q6)*sin(q1)*sin(q3)*sin(q5) -...
       Dwt*sin(q4)*sin(q1)*cos(q3)*cos(q6) -...
       Dew*sin(q4)*sin(q1)*cos(q3);   
J_03 = -Dwt*sin(q6)*sin(q4)*cos(q1)*cos(q2)*cos(q3)*cos(q5) +...
       Dwt*sin(q6)*sin(q4)*sin(q1)*sin(q3)*cos(q5) -...
       Dwt*sin(q6)*cos(q1)*cos(q4)*sin(q2)*cos(q5) +...
       Dwt*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q6) +...
       Dew*cos(q1)*cos(q2)*cos(q3)*cos(q4) -...
       Dwt*sin(q4)*cos(q1)*sin(q2)*cos(q6) -...
       Dwt*sin(q1)*sin(q3)*cos(q4)*cos(q6) -...
       Dew*sin(q4)*cos(q1)*sin(q2) - Dew*sin(q1)*sin(q3)*cos(q4);
J_04 = Dwt*sin(q6)*(-cos(q1)*cos(q2)*cos(q3)*cos(q4)*sin(q5) +...
       cos(q1)*sin(q2)*sin(q4)*sin(q5) +...
       cos(q4)*sin(q1)*sin(q3)*sin(q5) -...
       cos(q1)*cos(q2)*cos(q5)*sin(q3) -...
       cos(q3)*cos(q5)*sin(q1));   
J_05 = Dwt*(cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5)*cos(q6) -...
       cos(q1)*cos(q2)*cos(q3)*sin(q4)*sin(q6) -...
       cos(q1)*cos(q5)*cos(q6)*sin(q2)*sin(q4) -...
       cos(q4)*cos(q5)*cos(q6)*sin(q1)*sin(q3) -...
       cos(q1)*cos(q2)*cos(q6)*sin(q3)*sin(q5) +...
       sin(q1)*sin(q3)*sin(q4)*sin(q6) -...
       cos(q1)*cos(q4)*sin(q2)*sin(q6) -...
       cos(q3)*cos(q6)*sin(q1)*sin(q5));  
J_06 = 0;

J_10 = Dwt*cos(q1)*cos(q2)*cos(q3)*cos(q4)*sin(q6)*cos(q5) +...
       Dwt*cos(q6)*sin(q4)*cos(q1)*cos(q2)*cos(q3) -...
       Dwt*sin(q4)*cos(q1)*sin(q2)*sin(q6)*cos(q5) -...
       Dwt*cos(q1)*sin(q3)*cos(q2)*sin(q6)*sin(q5) -...
       Dwt*sin(q3)*sin(q1)*cos(q4)*sin(q6)*cos(q5) +...
       Dew*sin(q4)*cos(q1)*cos(q2)*cos(q3) -...
       Dwt*cos(q6)*sin(q4)*sin(q3)*sin(q1) +...
       Dwt*cos(q6)*cos(q1)*cos(q4)*sin(q2) -...
       Dwt*cos(q3)*sin(q1)*sin(q6)*sin(q5) -...
       Dew*sin(q4)*sin(q3)*sin(q1) +...
       Dew*cos(q1)*cos(q4)*sin(q2) + Dse*cos(q1)*sin(q2);  
J_11 = -sin(q1)*(Dwt*cos(q3)*cos(q4)*sin(q2)*sin(q6)*cos(q5) +...
       Dwt*cos(q6)*sin(q4)*cos(q3)*sin(q2) +...
       Dwt*sin(q4)*cos(q2)*sin(q6)*cos(q5) -...
       Dwt*sin(q3)*sin(q2)*sin(q6)*sin(q5) +...
       Dew*sin(q4)*cos(q3)*sin(q2) -...
       Dwt*cos(q6)*cos(q2)*cos(q4) -...
       Dew*cos(q2)*cos(q4) - Dse*cos(q2));
J_12 = -Dwt*sin(q3)*cos(q2)*sin(q1)*cos(q4)*sin(q6)*cos(q5) -...
       Dwt*cos(q6)*sin(q4)*sin(q3)*cos(q2)*sin(q1) +...
       Dwt*cos(q1)*cos(q3)*cos(q4)*sin(q6)*cos(q5) -...
       Dwt*cos(q2)*cos(q3)*sin(q1)*sin(q6)*sin(q5) -...
       Dew*sin(q4)*sin(q3)*cos(q2)*sin(q1) +...
       Dwt*cos(q6)*sin(q4)*cos(q1)*cos(q3) -...
       Dwt*cos(q1)*sin(q3)*sin(q6)*sin(q5) +...
       Dew*sin(q4)*cos(q1)*cos(q3);
J_13 = -Dwt*cos(q5)*sin(q6)*sin(q4)*cos(q2)*cos(q3)*sin(q1) -...
       Dwt*cos(q5)*sin(q6)*sin(q4)*cos(q1)*sin(q3) -...
       Dwt*cos(q5)*sin(q6)*sin(q1)*cos(q4)*sin(q2) +...
       Dwt*cos(q6)*cos(q2)*cos(q3)*sin(q1)*cos(q4) +...
       Dew*cos(q2)*cos(q3)*sin(q1)*cos(q4) -...
       Dwt*cos(q6)*sin(q4)*sin(q1)*sin(q2) +...
       Dwt*cos(q6)*cos(q1)*sin(q3)*cos(q4) -...
       Dew*sin(q4)*sin(q1)*sin(q2) +...
       Dew*cos(q1)*sin(q3)*cos(q4);
J_14 = Dwt*sin(q6)*(-cos(q2)*cos(q3)*cos(q4)*sin(q1)*sin(q5) -...
       cos(q2)*cos(q5)*sin(q1)*sin(q3) +...
       sin(q1)*sin(q2)*sin(q4)*sin(q5) -...
       cos(q1)*cos(q4)*sin(q3)*sin(q5) +...
       cos(q1)*cos(q3)*cos(q5));
J_15 = -Dwt*(cos(q4)*sin(q1)*sin(q2)*sin(q6) -...
       cos(q1)*cos(q3)*cos(q6)*sin(q5) +...
       cos(q1)*sin(q3)*sin(q4)*sin(q6) -...
       cos(q1)*cos(q4)*cos(q5)*cos(q6)*sin(q3) +...
       cos(q2)*cos(q3)*sin(q1)*sin(q4)*sin(q6) +...
       cos(q2)*cos(q6)*sin(q1)*sin(q3)*sin(q5) +...
       cos(q5)*cos(q6)*sin(q1)*sin(q2)*sin(q4) -...
       cos(q2)*cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(q1));
J_16 = 0;

J_20 = 0;
J_21 = -Dwt*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(q6) +...
       Dwt*sin(q5)*cos(q2)*sin(q3)*sin(q6) -...
       Dwt*cos(q2)*sin(q4)*cos(q3)*cos(q6) +...
       Dwt*sin(q4)*sin(q2)*cos(q5)*sin(q6) -...
       Dew*cos(q2)*sin(q4)*cos(q3) -...
       Dwt*cos(q4)*sin(q2)*cos(q6) -...
       Dew*cos(q4)*sin(q2) - Dse*sin(q2);
J_22 = sin(q2)*(Dwt*cos(q4)*cos(q5)*sin(q3)*sin(q6) +...
       Dwt*sin(q5)*cos(q3)*sin(q6) +...
       Dwt*sin(q4)*sin(q3)*cos(q6) + Dew*sin(q4)*sin(q3));
J_23 = Dwt*sin(q4)*cos(q3)*sin(q2)*cos(q5)*sin(q6) -...
       Dwt*cos(q2)*cos(q4)*cos(q5)*sin(q6) -...
       Dwt*cos(q3)*cos(q4)*sin(q2)*cos(q6) -...
       Dew*cos(q3)*cos(q4)*sin(q2) -...
       Dwt*cos(q2)*sin(q4)*cos(q6) - Dew*cos(q2)*sin(q4);
J_24 = Dwt*sin(q6)*(cos(q5)*sin(q2)*sin(q3) +...
       cos(q2)*sin(q4)*sin(q5) +...
       cos(q3)*cos(q4)*sin(q2)*sin(q5));
J_25 = Dwt*(-cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(q2) +...
       cos(q3)*sin(q2)*sin(q4)*sin(q6) -...
       cos(q2)*cos(q5)*cos(q6)*sin(q4) +...
       cos(q6)*sin(q2)*sin(q3)*sin(q5) -...
       cos(q2)*cos(q4)*sin(q6));
J_26 = 0;

J_30 = 0;
J_31 = -sin(q1);
J_32 = cos(q1)*sin(q2);
J_33 = -cos(q1)*cos(q2)*sin(q3) - cos(q3)*sin(q1);
J_34 = sin(q4)*cos(q1)*cos(q2)*cos(q3) -...
       sin(q4)*sin(q1)*sin(q3) + cos(q1)*cos(q4)*sin(q2);
J_35 = cos(q1)*sin(q2)*sin(q4)*sin(q5) -...
       cos(q1)*cos(q2)*cos(q5)*sin(q3) -...
       cos(q3)*cos(q5)*sin(q1) +...
       cos(q4)*sin(q1)*sin(q3)*sin(q5) -...
       cos(q1)*cos(q2)*cos(q3)*cos(q4)*sin(q5);
J_36 = sin(q6)*cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5) -...
       sin(q6)*sin(q4)*cos(q1)*sin(q2)*cos(q5) -...
       sin(q6)*sin(q1)*sin(q3)*cos(q4)*cos(q5) -...
       sin(q6)*sin(q3)*cos(q1)*cos(q2)*sin(q5) +...
       sin(q4)*cos(q1)*cos(q2)*cos(q3)*cos(q6) -...
       sin(q6)*sin(q1)*cos(q3)*sin(q5) -...
       sin(q4)*sin(q1)*sin(q3)*cos(q6) +...
       cos(q1)*cos(q4)*sin(q2)*cos(q6);

J_40 = 0;
J_41 = cos(q1);
J_42 = sin(q1)*sin(q2);
J_43 = cos(q1)*cos(q3) - cos(q2)*sin(q1)*sin(q3);
J_44 = sin(q4)*cos(q2)*cos(q3)*sin(q1) +...
       sin(q4)*cos(q1)*sin(q3) + cos(q4)*sin(q1)*sin(q2);
J_45 = cos(q1)*cos(q3)*cos(q5) -...
       cos(q2)*cos(q5)*sin(q1)*sin(q3) -...
       cos(q1)*cos(q4)*sin(q3)*sin(q5) +...
       sin(q1)*sin(q2)*sin(q4)*sin(q5) -...
       cos(q2)*cos(q3)*cos(q4)*sin(q1)*sin(q5);
J_46 = cos(q3)*cos(q5)*cos(q2)*sin(q1)*cos(q4)*sin(q6) +...
       cos(q1)*cos(q5)*sin(q3)*cos(q4)*sin(q6) +...
       cos(q3)*cos(q2)*sin(q1)*sin(q4)*cos(q6) -...
       cos(q5)*sin(q1)*sin(q2)*sin(q4)*sin(q6) -...
       cos(q2)*sin(q1)*sin(q3)*sin(q5)*sin(q6) +...
       cos(q1)*cos(q3)*sin(q5)*sin(q6) +...
       cos(q1)*sin(q3)*sin(q4)*cos(q6) +...
       sin(q1)*cos(q4)*sin(q2)*cos(q6);

J_50 = 1;
J_51 = 0;
J_52 = cos(q2);
J_53 = sin(q2)*sin(q3);
J_54 = cos(q2)*cos(q4) - cos(q3)*sin(q2)*sin(q4);
J_55 = cos(q5)*sin(q2)*sin(q3) + cos(q2)*sin(q4)*sin(q5) +...
       cos(q3)*cos(q4)*sin(q2)*sin(q5);
J_56 = cos(q5)*sin(q2)*cos(q3)*cos(q4)*sin(q6) -...
       cos(q5)*cos(q2)*sin(q4)*sin(q6) +...
       sin(q2)*sin(q3)*sin(q5)*sin(q6) -...
       sin(q2)*sin(q4)*cos(q3)*cos(q6) +...
       cos(q2)*cos(q4)*cos(q6);

J = [J_00 J_01 J_02 J_03 J_04 J_05 J_06;
     J_10 J_11 J_12 J_13 J_14 J_15 J_16;
     J_20 J_21 J_22 J_23 J_24 J_25 J_26;
     J_30 J_31 J_32 J_33 J_34 J_35 J_36;
     J_40 J_41 J_42 J_43 J_44 J_45 J_46;
     J_50 J_51 J_52 J_53 J_54 J_55 J_56
     ];
end


